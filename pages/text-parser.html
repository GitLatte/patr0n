<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metin ve Dosya İşleme - Linkleri Topla</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="icon" type="image/x-icon" href="https://gitlatte.github.io/patr0n/img/favicon.ico">
    <style>
        .parser-container {
            background-color: var(--secondary-color);
            border-radius: 8px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 4px 6px var(--shadow-color);
        }
        
        .input-area {
            background-color: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        textarea {
            width: 100%;
            min-height: 200px;
            background-color: var(--background-color);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 0.5rem;
            font-family: 'Consolas', monospace;
            resize: vertical;
        }
        
        .btn {
            background-color: var(--primary-color);
            color: var(--text-color);
            border: none;
            border-radius: 4px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: opacity 0.3s;
        }
        
        .btn:hover {
            opacity: 0.9;
        }


    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="https://gitlatte.github.io/patr0n/" data-page="index.html"><i class="fas fa-home"></i> Ana Sayfa</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="patron-iptv.html"><i class="fas fa-tv"></i> patr0n IPTV Linkleri</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="text-parser.html"><i class="fas fa-file-alt"></i> Metin/Dosya İşleme</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="url-parser.html"><i class="fas fa-link"></i> URL İşleme</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="ready-lists.html"><i class="fas fa-list"></i> Hazır Listeler</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container">
        <div class="parser-container">
            <h1><i class="fas fa-file-alt"></i> Metin ve Dosya İşleme</h1>
            <div class="input-area">
                <textarea id="inputText" placeholder="URL adreslerini almak istediğiniz metni buraya yapıştırın veya yazın..."></textarea>
                <div class="file-input">
                    <input type="file" id="fileInput" accept=".txt" style="display: none">
                    <button class="btn" onclick="document.getElementById('fileInput').click()">
                        <i class="fas fa-file-upload"></i> Dosya Seç
                    </button>
                    <span style="font-size:small">URL adreslerini ayıklamak istediğiniz dosyayı seçin</span>
                </div>
            </div>
            <button class="btn" onclick="extractLinks()">
                <i class="fas fa-search"></i> Linkleri Ayıkla
            </button>
            
            <div id="progressContainer" class="progress-bar" style="display: none;">
                <div id="progressBar" class="progress-fill"></div>
            </div>
            
            <div id="results" class="results parser-container" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h2>Bulunan Linkler</h2>
                    <button id="copyAllBtn" class="btn" onclick="copyAllLinks()">
                        <i class="fas fa-copy"></i> Tüm Linkleri Kopyala
                    </button>
                </div>
                <div id="linksList" class="list-group mt-3"></div>
            </div>
        </div>
        </div>
    </div>
    </main>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/main.js"></script>
    <script src="js/script.js"></script>
    <script>
        // File input handling
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('inputText').value = e.target.result;
                };
                reader.readAsText(file);
            }
        });

        // Progress bar handling
        const progressBar = new ProgressBar();

        // Link extraction
        async function extractLinks() {
            const input = document.getElementById('inputText').value;
            const results = document.getElementById('results');
            const linksList = document.getElementById('linksList');
            
            if (!input.trim()) {
                alert('Lütfen metin girin veya dosya seçin.');
                return;
            }
            
            // Reset and show progress
            progressBar.show(true);
            linksList.innerHTML = '';
            results.style.display = 'none';
            
            // Extract links using regex
            const urlPattern = /(https?:\/\/[^\s]+)/g;
            const links = input.match(urlPattern) || [];
            
            // Process links
            for (let i = 0; i < links.length; i++) {
                const link = utils.cleanURL(utils.decodeURL(links[i]));
                const progress = Math.round(((i + 1) / links.length) * 100);
                
                // Update progress
                progressBar.update(progress, i + 1);
                
                // Create link element with consistent styling
                const linkItem = document.createElement('div');
                linkItem.className = 'list-group-item d-flex justify-content-between align-items-center';
                
                const linkText = document.createElement('span');
                linkText.textContent = `${i + 1}. ${link}`;
                
                const copyButton = document.createElement('button');
                copyButton.className = 'btn btn-sm';
                copyButton.innerHTML = '<i class="fas fa-copy"></i>';
                copyButton.onclick = () => {
                    utils.copyToClipboard(link);
                    copyButton.innerHTML = '<i class="fas fa-check"></i>';
                    setTimeout(() => {
                        copyButton.innerHTML = '<i class="fas fa-copy"></i>';
                    }, 2000);
                };
                
                linkItem.appendChild(linkText);
                linkItem.appendChild(copyButton);
                linksList.appendChild(linkItem);
                
                // Add small delay for smooth progress
                await new Promise(resolve => setTimeout(resolve, 10));
            }
            
            // Show results
            results.style.display = 'block';
            document.getElementById('copyAllBtn').style.display = links.length ? 'block' : 'none';
            
            if (!links.length) {
                linksList.innerHTML = '<div class="alert alert-warning"><i class="fas fa-exclamation-triangle"></i> Hiç link bulunamadı.</div>';
            } else {
                linksList.insertAdjacentHTML('beforebegin', `<div class="alert alert-success"><i class="fas fa-check-circle"></i> ${links.length} link bulundu.</div>`);
            }
        }

        // Copy all links
        function copyAllLinks() {
            const links = Array.from(document.querySelectorAll('#linksList .list-group-item span'))
                .map(span => span.textContent.substring(span.textContent.indexOf('.') + 2))
                .join('\n');
            
            if (links) {
                utils.copyToClipboard(links);
                const copyAllBtn = document.getElementById('copyAllBtn');
                const originalHtml = copyAllBtn.innerHTML;
                copyAllBtn.innerHTML = '<i class="fas fa-check"></i> Kopyalandı';
                setTimeout(() => {
                    copyAllBtn.innerHTML = originalHtml;
                }, 2000);
            }
        }
    </script>
</body>
</html>
<style>
    .list-group {
        margin-top: 1rem;
    }

    .list-group-item {
        background-color: var(--secondary-color);
        border: 1px solid var(--border-color);
        color: var(--text-color);
        margin-bottom: 0.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
    }

    .list-group-item a {
        color: var(--text-color);
        text-decoration: none;
        word-break: break-all;
    }

    .list-group-item button {
        background-color: var(--primary-color);
        border: none;
        color: var(--text-color);
        padding: 0.5rem 1rem;
        border-radius: 4px;
        margin-left: 1rem;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .list-group-item button:hover {
        background-color: var(--hover-color);
    }

    .list-group-item:hover {
        background-color: var(--hover-color);
    }

    .list-group-item a {
        color: var(--text-color);
        text-decoration: none;
        word-break: break-all;
    }

    .list-group-item button {
        background-color: var(--primary-color);
        color: var(--text-color);
        border: none;
        border-radius: 4px;
        padding: 0.5rem 1rem;
        margin-left: 1rem;
        cursor: pointer;
        transition: opacity 0.3s;
    }

    .list-group-item button:hover {
        opacity: 0.9;
    }

    .alert {
        padding: 1rem;
        border-radius: 4px;
        margin-bottom: 1rem;
    }

    .alert-success {
        background-color: var(--success-color);
        color: var(--text-color);
    }

    .alert-warning {
        background-color: var(--warning-color);
        color: var(--text-color);
    }
</style>
